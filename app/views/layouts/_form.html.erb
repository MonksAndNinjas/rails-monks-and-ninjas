<% if !errors.blank? %>
<div>
  <h2 class="shadow">
    <%= pluralize(errors.count, "error") %>
    <%= "prohibited this #{@current_user} from being saved:" %>
  </h2>

  <ul>
  <% errors.each do |msg| %>
<!-- maybe write something here to allow me to go back to my new page since user was not updated -->
    <li><%= msg %></li>
  <% end %>
  </ul>
</div>
<% end %>

<%= form_for user do |f| %>

  <%= f.fields_for :nested_attributes do |attr| %>
    <% nested_attributes.attr_keys.each do |key| %>

      <% data_type = nested_attributes.get_data_type_for(key) %>
<!-- find data type then create label and field -->
      <%= attr.label "#{key.to_s}" unless invalid_label?(key)  %><br>
      <%= display_field_using(key, data_type, attr) %><br>

    <% end %>
  <% end %>

  <br></br>

  <%= f.hidden_field :extraparam, :value => "#{controller_name}" %>

  <%= f.password_field :password, placeholder: "password" %>

  <%= f.submit "Create", class: "button" %>
<% end %>
